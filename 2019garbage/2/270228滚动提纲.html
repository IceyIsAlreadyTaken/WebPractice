<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <style>
    .scroll{
      position: fixed;
      right:0px;
      top:0px;
      padding:0px;  
      border:5px solid;
    }
    .red{
      background:red;
    }
  </style>
</head>
<body>
  <section>
    <!-- (h2{$$$}+p*5>lorem)*10 -->
    <h2>001</h2>
    <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Consequatur provident dignissimos soluta ipsa facilis repudiandae animi blanditiis? Possimus enim sit ipsa illum nam quis neque, nemo, quod recusandae molestiae laborum?</p>
    <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. In obcaecati molestias est quasi quibusdam vero non facilis alias odio ad quidem animi illum a suscipit explicabo accusantium, ipsam corrupti! Saepe?</p>
    <p>Lorem, ipsum dolor sit amet consectetur adipisicing elit. Sed nam ratione qui rem dolore. Quisquam iure nulla, ad doloribus, officia ducimus obcaecati quasi enim consectetur dolore vitae voluptatem sapiente libero.</p>
    <p>Lorem ipsum dolor sit amet consectetur, adipisicing elit. Exercitationem, sint? Recusandae, iusto sed atque tempore corrupti quod quisquam aut veniam ad, asperiores quasi necessitatibus voluptatum sit accusantium, illum tenetur velit!</p>
    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Reiciendis minima error dolores ipsam doloribus autem eius vero eligendi, nobis, libero, consequatur eaque debitis suscipit repudiandae iure rem dignissimos architecto assumenda.</p>
    <h2>002</h2>
    <p>Labore placeat doloribus aut, possimus temporibus sit deleniti incidunt tempora accusantium, adipisci aliquid nam rem similique tenetur beatae delectus. Doloremque est maxime veniam nostrum dicta voluptatibus, neque labore at quam.</p>
    <p>Ipsam animi optio ipsa? Obcaecati minima, est eos alias cum laborum eius magnam? Esse dolorum voluptatum consectetur beatae sequi aperiam quisquam suscipit eveniet, debitis voluptatem libero inventore veritatis, quis soluta.</p>
    <p>Iusto doloribus quasi, quam natus molestias saepe incidunt? Ullam ut animi voluptas facere laudantium exercitationem a labore voluptates ea sed eligendi debitis, dicta reprehenderit minus consequuntur illum maxime, perferendis quas?</p>
    <p>Fuga, quam rem voluptate doloremque dolores distinctio vel tempore at. Corrupti fuga, atque nesciunt facere, ut blanditiis accusantium perspiciatis reiciendis corporis minima dicta ratione ab dolore officiis dignissimos saepe sit.</p>
    <p>Quisquam, cupiditate maiores quidem quam nostrum sed quo quod. Labore explicabo dolor, deleniti rem dicta laudantium eos soluta esse aliquid repudiandae ut minima, consectetur quisquam facere quod suscipit vitae quasi.</p>
    <h2>003</h2>
    <p>Recusandae facere, rerum ipsam illum dolor sapiente necessitatibus fuga enim blanditiis labore quis corrupti provident quia dolorem dolore hic quos quas iusto. Soluta adipisci libero praesentium officiis maiores iure odit!</p>
    <p>Similique, natus eum vero at asperiores veritatis voluptate atque voluptatem quam non, officia rerum architecto molestias, qui amet. Ipsum quam ad quae dicta nisi numquam totam a porro fugit quod?</p>
    <p>Consequuntur modi mollitia, voluptatum corporis ex earum. Amet officiis, ullam, nobis sequi vero explicabo fuga fugit ipsum blanditiis rerum nostrum repudiandae hic cupiditate excepturi quos facere, vitae ad ab consequuntur?</p>
    <p>Nemo optio, adipisci eos eveniet expedita facere consequatur provident nesciunt alias repellat veniam obcaecati, dolores dignissimos exercitationem laboriosam laborum neque corporis doloremque saepe eius animi, incidunt atque blanditiis voluptate! Quasi?</p>
    <p>Aspernatur ea, officiis id animi corporis doloribus sapiente deserunt aut voluptatem repudiandae pariatur itaque, accusantium culpa impedit. Labore minus vel molestiae, inventore, necessitatibus, explicabo nulla quibusdam ut quidem quos fuga.</p>
    <h2>004</h2>
    <p>Necessitatibus consequuntur vel totam possimus quisquam quaerat fugit hic, id perspiciatis, libero ducimus quia fugiat at maxime similique aliquam sint cumque. Veritatis quae corrupti repellat aspernatur eaque sit totam officia.</p>
    <p>Libero et, tempora, debitis tenetur doloremque quibusdam, odio asperiores alias animi vitae itaque nesciunt. Odio nulla numquam rerum officia quasi repellendus id voluptatem tenetur molestiae, culpa et eaque consequuntur consequatur?</p>
    <p>Eligendi hic culpa qui pariatur, reiciendis autem labore quae blanditiis, error maiores dolore quos fugiat perferendis? Repudiandae sit maiores, omnis expedita neque laboriosam dicta laudantium deleniti architecto totam! Laudantium, doloribus?</p>
    <p>Rem error magnam ullam incidunt sit? Excepturi officia facere eius saepe ducimus, iste laborum aliquam unde quae libero ut at expedita totam omnis quasi. Aut labore necessitatibus rerum perferendis nobis?</p>
    <p>Nam itaque perspiciatis quod quae dolores dicta non, explicabo ex! Iure obcaecati a quaerat officiis, esse nihil ipsam. Accusamus nostrum voluptates asperiores molestiae aspernatur fugit at eligendi voluptas quasi rem?</p>
    <h2>005</h2>
    <p>Sapiente consequatur voluptatem omnis hic expedita atque doloribus voluptatibus, ducimus aliquid illo nemo, magnam adipisci veniam ad nesciunt. Velit voluptates dolores soluta similique quaerat corporis dignissimos quos aliquid suscipit! Enim.</p>
    <p>Atque eveniet at rem, optio dicta aut maiores consequatur, blanditiis non saepe quam, ut adipisci fugit similique. Id iusto blanditiis, officiis quo ducimus enim perferendis excepturi maiores quia a consequuntur.</p>
    <p>Dicta, hic! Ut tempora tenetur cupiditate eius quidem error velit, vel laboriosam cumque dicta, commodi, nihil asperiores facere. Unde ratione nesciunt laudantium pariatur. Temporibus nesciunt non dolorem asperiores consequuntur officiis?</p>
    <p>Mollitia fugit ipsam placeat sed blanditiis id cumque aliquid beatae neque numquam eaque a culpa illo, quibusdam, ut accusamus quasi ullam! Incidunt officiis quas iste omnis tenetur repudiandae quibusdam rem.</p>
    <p>Quaerat sed rem, voluptatum, adipisci harum numquam non omnis soluta libero expedita fuga perferendis sit neque praesentium, assumenda minima perspiciatis minus. Obcaecati id fugit natus nisi ea ex molestiae quas?</p>
    <h2>006</h2>
    <p>Animi est tempore maxime facilis voluptas vel sint obcaecati numquam eaque repellendus dolorum, nostrum vitae aperiam nobis aspernatur modi et ullam amet, architecto illum quidem? Voluptatem sint sunt voluptas quidem?</p>
    <p>Quo enim repellat sapiente corporis optio dolore iusto atque nobis, dicta, similique eligendi, pariatur voluptatum quod. Nulla dolores ab, nisi eaque doloremque, delectus, sed aliquam quae aut maiores velit ducimus.</p>
    <p>Mollitia fugiat veritatis recusandae enim tempore! Voluptatibus atque modi distinctio ut ea reprehenderit dolore ad, fuga tempore odit minus doloribus aliquid quod praesentium est! Et voluptates doloribus ipsum! Sint, quos.</p>
    <p>Aspernatur veniam assumenda ducimus facilis cumque explicabo officia odit fuga architecto, placeat cupiditate provident tenetur, dolore inventore quae ipsam culpa illum aperiam reprehenderit dolorum consequuntur beatae sit, nam consectetur. Quibusdam.</p>
    <p>Velit sapiente quia tempora quibusdam veritatis harum est vel voluptas et voluptates eligendi doloribus mollitia nam reiciendis qui, architecto neque vitae inventore placeat quis delectus animi distinctio ab. Aspernatur, voluptatem.</p>
    <h2>007</h2>
    <p>Cumque dignissimos, labore voluptatibus ipsum nihil quos at maxime ullam quis similique quisquam! Officia eveniet fugiat, laboriosam doloribus natus ut vero dolorum eius, nostrum excepturi unde ipsum et optio pariatur.</p>
    <p>Rem voluptatibus, suscipit recusandae labore molestiae eaque consequuntur quasi sit iste asperiores iure. Perferendis sapiente, exercitationem sequi distinctio sit impedit dolorum tenetur iusto deserunt, porro ipsa reiciendis atque harum ad?</p>
    <p>Amet exercitationem enim velit ullam sequi voluptatem laudantium accusamus magnam ipsum quas, soluta, quam alias ex repellendus in totam sapiente! Quia illum tempora quo incidunt nam? Sed maxime aut fugit.</p>
    <p>Mollitia earum ipsum nam. Porro, dolorem recusandae, hic deserunt illo eligendi veniam temporibus natus voluptate voluptas animi saepe? Neque sapiente modi dolorem aut nam totam maiores adipisci, maxime nemo iste.</p>
    <p>Blanditiis, eum. Quasi quaerat, quibusdam nesciunt consequatur soluta tempore doloribus vero blanditiis voluptatem neque, cumque distinctio. Incidunt ratione qui quibusdam, vel possimus quia rem esse vero soluta ab, quasi ducimus!</p>
    <h2>008</h2>
    <p>Hic inventore minus qui temporibus. Atque praesentium explicabo esse mollitia, blanditiis nostrum soluta enim omnis qui assumenda culpa unde optio harum dignissimos. Nesciunt delectus eaque sequi accusamus impedit quaerat minus!</p>
    <p>Repellendus fugit neque veritatis commodi nemo nesciunt, consequatur hic nostrum non obcaecati a quidem laudantium natus accusantium atque autem officia incidunt fugiat quis assumenda iure facere! Facere iste necessitatibus expedita?</p>
    <p>Animi rem maxime facilis nemo porro sapiente accusantium ad, repellendus esse beatae minus nisi, officiis quidem quae? Ad, quo, quisquam earum harum ullam ut quia pariatur atque minima facilis id.</p>
    <p>Modi, animi! Quis consectetur cupiditate qui iste asperiores id labore, ab, unde suscipit explicabo vel facere quidem hic eveniet deserunt ex placeat voluptatibus corporis, voluptates quasi delectus? Ab, aspernatur numquam!</p>
    <p>Quod repellat odio earum omnis ipsam maxime dolore delectus distinctio qui, exercitationem, odit fugiat quam quibusdam voluptates. Enim ex est porro. Excepturi deleniti nisi, architecto necessitatibus tempore a adipisci eligendi.</p>
    <h2>009</h2>
    <p>Quo ea fugit, beatae non voluptas quod quae, facere rem commodi voluptate cum rerum? Natus nostrum dolorem odit ratione magnam. Animi doloribus illo sed inventore! Esse delectus facilis quisquam labore?</p>
    <p>Labore, molestias quod odit ratione recusandae nisi sunt et ipsum, consequuntur sed voluptatem quo harum ea, quaerat voluptates fuga omnis explicabo voluptatibus iure doloribus repellendus repudiandae neque asperiores cupiditate? Corrupti!</p>
    <p>Ipsa quidem vitae aliquam quos itaque, alias beatae. Exercitationem, alias facere maxime, voluptate excepturi in vero suscipit officia dolorum eius vitae ipsam! Pariatur est consequuntur eum veritatis, suscipit maxime velit.</p>
    <p>Vitae itaque earum libero eaque quidem vero magni, expedita est, doloribus dolores quas. Libero, labore? Quam quo, blanditiis tempora modi quia dolorem corporis quidem laudantium deserunt veniam nihil, enim quos!</p>
    <p>Beatae unde cupiditate rem dolore architecto atque nostrum tempora soluta exercitationem excepturi eaque, nam quas vitae ipsum, labore odit quisquam impedit inventore modi veniam consequuntur voluptate adipisci? Laborum, eaque magnam.</p>
    <h2>010</h2>
    <p>Sequi officiis distinctio cumque optio adipisci? Quasi illo fuga numquam, dolor facilis itaque quis maiores quisquam magnam asperiores laudantium. Cumque sint iusto dolore nulla impedit incidunt commodi similique itaque sapiente.</p>
    <p>Ad explicabo ratione expedita odit praesentium ipsa laudantium consequatur dicta earum excepturi mollitia facilis non ea, facere vero cum possimus soluta laboriosam minima eligendi velit debitis sapiente! Exercitationem, eveniet amet.</p>
    <p>Sunt ducimus beatae ipsam laudantium earum dolorem, commodi laborum quos, cupiditate itaque, asperiores ut? Qui doloremque est cupiditate magni ipsam molestias delectus commodi libero enim suscipit hic, deserunt culpa dolore?</p>
    <p>A veritatis asperiores, aspernatur laudantium qui, corporis modi repellat vel nam nihil labore sed fugiat veniam, ad ut. Odit, minus dolores. Cupiditate minus neque labore possimus esse officia aperiam alias!</p>
    <p>Quae sunt voluptate, optio facere, mollitia magnam atque veritatis perspiciatis delectus iusto dolorem. Culpa maxime reiciendis autem aperiam soluta nesciunt tenetur, alias fugit minima, rerum repudiandae odio illo quia. Accusantium.</p>
  </section>
</body>
<script>
// script 写在body外边是失效的，浏览器会把它转进body
  var items = Array.from(document.querySelectorAll('section h2')) //类数组对象
  var ul = document.createElement('ul')
  ul.classList.add('scroll')
  items.forEach(element => {
    var li = document.createElement('li')
    var a = document.createElement('a')
    a.innerText = element.innerText
    element.id = element.innerText
    a.href = '#' +  element.id  
    li.appendChild(a)
    ul.appendChild(li)
  });
  document.body.appendChild(ul)
  window.addEventListener('scroll',function(e){
    //console.log(items instanceof Object)
   var underTop = items.filter(it => {
      var rect = it.getBoundingClientRect()
      return rect.top > 0
    })
    //console.log(underTop)
    var curr = underTop[0]
    var idx = items.findIndex(it => it == curr)
    //console.log(ul.children) 也是类数组对象不能使用forEach
    Array.from(ul.children).forEach(it => it.classList.remove('red'))
    ul.children[idx].classList.add('red')
  })
</script>
</html>